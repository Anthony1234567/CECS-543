<!DOCTYPE html>
<html>
  <head>
    <title>CECS 543: Version Control System</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="../js/controllerB.js"></script>
  </head>

  <body>
    <div 
      id="directory"
      class="directory">
    </div>

    <div class="dropdown">
      <button class="dropdown-button">
        Action 
        <i class="arrow down"></i>
      </button>

      <div class="dropdown-content">
        <a href="javascript:void(0)" onclick="Controller.commit()">Commit</a>
        <a href="javascript:void(0)" onclick="openModal('Check In')">Check In</a>
        <a href="javascript:void(0)" onclick="openModal('Check Out')">Check Out</a>
      </div>
    </div>

    <!-- The Modal -->
    <div 
      id="myModal" 
      class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="main-content">
          <input 
            type="text" 
            id="directory-field" 
            placeholder="Enter Directory"
            class="input-light"
            style="flex-grow: 1; margin-right: 1em;">
          
          <button 
            id="actionButton"
            class="button-light">
            Go!
          </button>
        </div>
      </div>
    </div>
  </body>

  <script type="text/javascript">
    (function() {
      // Get the modal
      var modal = document.getElementById('myModal');
      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName('close')[0];

      document.getElementById('directory').innerHTML = decodeURIComponent(new URL(window.location.href).searchParams.get('projectRoot'));

      // When the user clicks on <span> (x), close the modal
      span.onclick = function() {
        modal.style.display = 'none';
        document.getElementById('directory-field').value = '';
      }

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
          document.getElementById('directory-field').value = '';
        }
      }
    })();

    function openModal(type) {
      switch (type) {
        case 'Check In':
          document.getElementById('directory-field').placeholder = 'Enter Source Directory';
          document.getElementById('actionButton').innerHTML = 'Check In';

          // TODO: Implement call to Controller.checkIn()
          document.getElementById('actionButton').onclick = function() {
            window.alert('TODO: Implement call to Controller.checkIn()');
          }

          break;
        case 'Check Out':
          document.getElementById('directory-field').placeholder = 'Enter Target Directory';
          document.getElementById('actionButton').innerHTML = 'Check Out';

          // TODO: Implement call to Controller.checkOut()
          document.getElementById('actionButton').onclick = function() {
            window.alert('TODO: Implement call to Controller.checkOut()');
          }

          break;
        default:
          console.warn('Unknown Command.');
      }

      document.getElementById('myModal').style.display = 'block';
    }
  </script>
</html>
